{% extends "lunchclub/base.html" %}
{% block head %}
<style>
.balance td { text-align: right; }
</style>
{% endblock %}
{% block content %}

<h1>Lunchclub</h1>

{% if user.is_authenticated %}
<p>Welcome to the lunchclub, {{ user }}!</p>

<form method="post" action="{% url 'expense_create' %}">{% csrf_token %}
    <input type="hidden" name="myself" value="yes" />
    <input name="expense" type="number" placeholder="Enter expense" min="0.01" max="400" step="any" />
    <input type="submit" value="Enter expense" />
</form>

<p><a href="{% url 'attendance_today' %}">Enter today's attendance</a>
&bull;
<a href="{% url 'attendance_create' %}">Enter attendance for past month</a></p>

<p><a href="{% url 'expense_create' %}">Enter someone else's expense</a>
&bull;
<a href="{% url 'edit' %}">View database</a></p>
{% else %}
<p>Welcome to the lunchclub! Contact the lunchclub admin to get a login.</p>
{% endif %}

{% if user.is_superuser %}
<p>
Admin pages (only for Django superusers):
<a href="{% url 'edit' %}">Edit database</a>
&bull;
<a href="{% url 'accesstoken_list' %}">Manage access tokens</a>
</p>
{% endif %}

<table class="balance">
<thead>
<tr>
<th>Name</th>
<th>Total</th>
{% for month in months %}
<th>{{ month.name }}</th>
{% endfor %}
</tr>
<tr>
<th>Price</th>
<td>{{ total_price|floatformat:2 }}</td>
{% for month in months %}
<td>{{ month.price|floatformat:2 }}</td>
{% endfor %}
</tr>
</thead>
<tbody>
{% for person in persons %}
<th>{{ person.username }}</th>
<td>{{ person.balance|floatformat:2 }}</td>
{% for month in person.months %}
<td>{{ month.balance|floatformat:2 }}</td>
{% endfor %}
</tr>
{% endfor %}
</tbody>
</table>
<form method="get">{{ search_form.as_p }}<input type="submit" value="Show balance" /></form>
{% endblock %}
